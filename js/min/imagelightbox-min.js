!function($,n,t,e){"use strict";var i=function(){var n=t.body||t.documentElement,n=n.style;return""==n.WebkitTransition?"-webkit-":""==n.MozTransition?"-moz-":""==n.OTransition?"-o-":""==n.transition&&""},o=i()!==!1,r=function(n,t,e){var o={},r=i();o[r+"transform"]="translateX("+t+")",o[r+"transition"]=r+"transform "+e+"s linear",n.css(o)},a="ontouchstart"in n,u=n.navigator.pointerEnabled||n.navigator.msPointerEnabled,d=function(n){if(a)return!0;if(!u||"undefined"==typeof n||"undefined"==typeof n.pointerType)return!1;if("undefined"!=typeof n.MSPOINTER_TYPE_MOUSE){if(n.MSPOINTER_TYPE_MOUSE!=n.pointerType)return!0}else if("mouse"!=n.pointerType)return!0;return!1};$.fn.imageLightbox=function(e){var e=$.extend({selector:'id="imagelightbox"',animationSpeed:250,preloadNext:!0,enableKeyboard:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,onStart:!1,onEnd:!1,onLoadStart:!1,onLoadEnd:!1},e),i=$([]),c=$(),f=$(),l=0,p=0,g=0,s=!1,h=function(){if(!f.length)return!0;var t=.8*$(n).width(),e=.9*$(n).height(),i=new Image;i.src=f.attr("src"),i.onload=function(){if(l=i.width,p=i.height,l>t||p>e){var o=l/p>t/e?l/t:p/e;l/=o,p/=o}f.css({width:l+"px",height:p+"px",top:($(n).height()-p)/2+"px",left:($(n).width()-l)/2+"px"})}},m=function(n){if(s)return!1;if(n="undefined"!=typeof n&&("left"==n?1:-1),f.length){if(n!==!1&&(i.length<2||e.quitOnEnd===!0&&(n===-1&&0==i.index(c)||1===n&&i.index(c)==i.length-1)))return x(),!1;var t={opacity:0};o?r(f,100*n-g+"px",e.animationSpeed/1e3):t.left=parseInt(f.css("left"))+100*n+"px",f.animate(t,e.animationSpeed,function(){v()}),g=0}s=!0,e.onLoadStart!==!1&&e.onLoadStart(),setTimeout(function(){f=$("<img "+e.selector+" />").attr("src",c.attr("href")).on("load",function(){f.appendTo("body"),h();var t={opacity:1};if(f.css("opacity",0),o)r(f,-100*n+"px",0),setTimeout(function(){r(f,"0px",e.animationSpeed/1e3)},50);else{var a=parseInt(f.css("left"));t.left=a+"px",f.css("left",a-100*n+"px")}if(f.animate(t,e.animationSpeed,function(){s=!1,e.onLoadEnd!==!1&&e.onLoadEnd()}),e.preloadNext){var u=i.eq(i.index(c)+1);u.length||(u=i.eq(0)),$("<img />").attr("src",u.attr("href"))}}).on("error",function(){e.onLoadEnd!==!1&&e.onLoadEnd()});var t=0,a=0,p=0;f.on(u?"pointerup MSPointerUp":"click",function(n){if(n.preventDefault(),e.quitOnImgClick)return x(),!1;if(d(n.originalEvent))return!0;var t=(n.pageX||n.originalEvent.pageX)-n.target.offsetLeft;c=i.eq(i.index(c)-(l/2>t?1:-1)),c.length||(c=i.eq(l/2>t?i.length:0)),m(l/2>t?"left":"right")}).on("touchstart pointerdown MSPointerDown",function(n){return!(d(n.originalEvent)&&!e.quitOnImgClick)||(o&&(p=parseInt(f.css("left"))),void(t=n.originalEvent.pageX||n.originalEvent.touches[0].pageX))}).on("touchmove pointermove MSPointerMove",function(n){return!(d(n.originalEvent)&&!e.quitOnImgClick)||(n.preventDefault(),a=n.originalEvent.pageX||n.originalEvent.touches[0].pageX,g=t-a,void(o?r(f,-g+"px",0):f.css("left",p-g+"px")))}).on("touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",function(n){return!(d(n.originalEvent)&&!e.quitOnImgClick)||void(Math.abs(g)>50?(c=i.eq(i.index(c)-(g<0?1:-1)),c.length||(c=i.eq(g<0?i.length:0)),m(g>0?"right":"left")):o?r(f,"0px",e.animationSpeed/1e3):f.animate({left:p+"px"},e.animationSpeed/2))})},e.animationSpeed+100)},v=function(){return!!f.length&&(f.remove(),void(f=$()))},x=function(){return!!f.length&&void f.animate({opacity:0},e.animationSpeed,function(){v(),s=!1,e.onEnd!==!1&&e.onEnd()})},E=function(n){n.each(function(){i=i.add($(this))}),n.on("click.imageLightbox",function(n){return n.preventDefault(),!s&&(s=!1,e.onStart!==!1&&e.onStart(),c=$(this),void m())})};return $(n).on("resize",h),e.quitOnDocClick&&$(t).on(a?"touchend":"click",function(n){f.length&&!$(n.target).is(f)&&x()}),e.enableKeyboard&&$(t).on("keyup",function(n){return!f.length||(n.preventDefault(),27==n.keyCode&&x(),void(37!=n.keyCode&&39!=n.keyCode||(c=i.eq(i.index(c)-(37==n.keyCode?1:-1)),c.length||(c=i.eq(37==n.keyCode?i.length:0)),m(37==n.keyCode?"left":"right"))))}),E($(this)),this.switchImageLightbox=function(n){var t=i.eq(n);if(t.length){var e=i.index(c);c=t,m(n<e?"left":"right")}return this},this.addToImageLightbox=function(n){E(n)},this.quitImageLightbox=function(){return x(),this},this}}(jQuery,window,document);